---
title: "pesticide_risk_plots"
author: "Joe Collins"
date: "`r Sys.Date()`"
output: pdf_document
---

# Pesticide Risk Plots


Set the working directory and load the necessary packages

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# # Set the root directory for the R Markdown file
# knitr::opts_knit$set(root.dir = "~/OneDrive - Harper Adams University/Data/agronomy/")


# PACKAGES ####

library(dplyr)
library(purrr) # For list filtering
library(stringr) # replace characters
library(ggplot2) # plotting 
library(tidyr)
library(ggpubr)
```




# Data 

Read the combined data set

```{r load data}
#combined_dat <- read.csv(file = "data/pesticide_data/pesticide_properties_data.csv")

# source(file = "~/Documents/GitHub/pesticide_info_web_scraper/pesticide_risk_summary_stats.R")


dat <- read.csv(file = "sym_link_pesticide_data/data/pesticide_data/danish_pli_total_pli_data.csv")

```





#________________________________
# Plots by year

# ~ Total PLI x rate


```{r Total PLI plots}

sum <- 
   dat %>%
  group_by(year, treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(total_pli_x_rate, na.rm = TRUE), digits = 2)
  )


p1 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Total PLI", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

p1

```



# ~ Ecotoxicity PLI x rate


```{r ecotox pli plots}

names(dat)

sum <- 
   dat %>%
  group_by(year, treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(ecotox_indic_x_rate, na.rm = TRUE), digits = 2)
  )


p2 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Ecotoxicity", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

p2

```




# ~ Environmental fate PLI x rate


```{r ecotox pli plots}

names(dat)

sum <- 
   dat %>%
  group_by(year, treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(env_fate_indic_x_rate, na.rm = TRUE), digits = 2)
  )


p3 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Environmental fate", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

p3

```




# ~ Human health PLI x rate


```{r human health pli plots}

names(dat)

sum <- 
   dat %>%
  group_by(year, treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(human_health_indic_x_rate, na.rm = TRUE), digits = 2)
  )


p4 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Human Health", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

p4

```



# ~ Total mass PLI x rate


```{r total ppp mass plots}

names(dat)

sum <- 
   dat %>%
  group_by(year, treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(avg_normalized_rate_kg_ha, na.rm = TRUE), digits = 2)
  )


p5 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = expression("Total mass (kg"~"ha"^{-1}~")"), 
    x = "Treatment",
    y = expression("Total mass (kg"~"ha"^{-1}~")")) +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

p5

```

# joint plot 


```{r joint plot}

ggarrange(p2,p3,p4,p5,p1, 
          ncol = 3, 
          nrow = 2, 
          labels = c("A","B","C","D","E"), 
          common.legend = TRUE, legend = "bottom")

```

```{r}

ggsave(filename = "sym_link_pesticide_data/plots/pesticide_risk_plots/danish_pli_join_plot.png",
       width = 10, height = 6)

```






#________________________________
# Plots by treatment

# ~ Total PLI x rate


```{r Total PLI plots}

sum <- 
   dat %>%
  group_by(treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(total_pli_x_rate, na.rm = TRUE), digits = 2)
  )


p1 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Total PLI", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) 

p1

```



# ~ Ecotoxicity PLI x rate


```{r ecotox pli plots}

names(dat)

sum <- 
   dat %>%
  group_by(treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(ecotox_indic_x_rate, na.rm = TRUE), digits = 2)
  )


p2 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Ecotoxicity", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) 

p2

```




# ~ Environmental fate PLI x rate


```{r ecotox pli plots}

names(dat)

sum <- 
   dat %>%
  group_by(treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(env_fate_indic_x_rate, na.rm = TRUE), digits = 2)
  )


p3 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Environmental fate", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) 

p3

```




# ~ Human health PLI x rate


```{r human health pli plots}

names(dat)

sum <- 
   dat %>%
  group_by(treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(human_health_indic_x_rate, na.rm = TRUE), digits = 2)
  )


p4 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Human Health", 
    x = "Treatment",
    y = "PLI") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) 

p4

```



# ~ Total mass PLI x rate


```{r total ppp mass plots}

names(dat)

sum <- 
   dat %>%
  group_by(treatment) %>%
  summarise(
    n = n(),
    sum = round(x = sum(avg_normalized_rate_kg_ha, na.rm = TRUE), digits = 2)
  )


p5 <-
ggplot(data = sum, 
            aes(x = treatment, 
                y = sum, 
                fill = treatment)) +
geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = expression("Total mass (kg"~"ha"^{-1}~")"), 
    x = "Treatment",
    y = expression("Total mass (kg"~"ha"^{-1}~")")) +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) 

p5

```

# joint plot 


```{r joint plot}

ggarrange(p2,p3,p4,p5,p1, 
          ncol = 5, 
          nrow = 1, 
          labels = c("A","B","C","D","E"), 
          common.legend = TRUE, legend = "bottom")

```

```{r}

ggsave(filename = "sym_link_pesticide_data/plots/pesticide_risk_plots/danish_pli_treatment_joint_plot.png",
       width = 10, height = 3.5)

```






#______________________________
# Proportions 



# ~ application rates 
```{r}

# Summarize total usage by category and treatment
category_summary <- dat %>%
  group_by(treatment, category) %>%  # Group by both treatment and category
  summarise(total_usage = sum(avg_normalized_rate_kg_ha, na.rm = TRUE), .groups = "drop") %>%
  group_by(treatment) %>%  # Group again by treatment to calculate proportions correctly
  mutate(percentage = (total_usage / sum(total_usage)) * 100) %>%
  ungroup()



a <-
ggplot(category_summary, aes(x = treatment, y = percentage, fill = category)) +
  geom_col(position = "stack") +  # Stacked bars
  scale_fill_brewer(palette = "Set1") +  # Change to any Brewer palette
  labs(subtitle = "Total Mass",
       x = "Treatment",
       y = "Proportion (%)",
       fill = "Pesticide Category") +
  theme_minimal()

a


```


# ~ total PLI
```{r}

# Summarize total usage by category and treatment
category_summary <- dat %>%
  group_by(treatment, category) %>%  # Group by both treatment and category
  summarise(total_x = sum(total_pli, na.rm = TRUE), .groups = "drop") %>%
  group_by(treatment) %>%  # Group again by treatment to calculate proportions correctly
  mutate(percentage = (total_x / sum(total_x)) * 100) %>%
  ungroup()



b <-
ggplot(category_summary, 
       aes(x = treatment, 
           y = percentage, 
           fill = category)) +
  geom_col(position = "stack") +  # Stacked bars
  scale_fill_brewer(palette = "Set1") +  # Change to any Brewer palette
  labs(subtitle = "Total PLI",
       x = "Treatment",
       y = "Proportion (%)",
       fill = "Pesticide Category") +
  theme_minimal()


b

```


# ~ ecotoxicity PLI
```{r}

# Summarize total usage by category and treatment
category_summary <- dat %>%
  group_by(treatment, category) %>%  # Group by both treatment and category
  summarise(total_x = sum(EcoTox_Indicator, na.rm = TRUE), .groups = "drop") %>%
  group_by(treatment) %>%  # Group again by treatment to calculate proportions correctly
  mutate(percentage = (total_x / sum(total_x)) * 100) %>%
  ungroup()



c <-
ggplot(category_summary, 
       aes(x = treatment, 
           y = percentage, 
           fill = category)) +
  geom_col(position = "stack") +  # Stacked bars
  scale_fill_brewer(palette = "Set1") +  # Change to any Brewer palette
  labs(subtitle = "Ecotoxicity",
       x = "Treatment",
       y = "Proportion (%)",
       fill = "Pesticide Category") +
  theme_minimal()


c

```



# ~ environmental fate PLI
```{r}

# Summarize total usage by category and treatment
category_summary <- dat %>%
  group_by(treatment, category) %>%  # Group by both treatment and category
  summarise(total_x = sum(Env_Fate_Indicator, na.rm = TRUE), .groups = "drop") %>%
  group_by(treatment) %>%  # Group again by treatment to calculate proportions correctly
  mutate(percentage = (total_x / sum(total_x)) * 100) %>%
  ungroup()



d <-
ggplot(category_summary, 
       aes(x = treatment, 
           y = percentage, 
           fill = category)) +
  geom_col(position = "stack") +  # Stacked bars
  scale_fill_brewer(palette = "Set1") +  # Change to any Brewer palette
  labs(subtitle = "Environmental fate",
       x = "Treatment",
       y = "Proportion (%)",
       fill = "Pesticide Category") +
  theme_minimal()


d

```


# ~ Human health PLI
```{r}

# Summarize total usage by category and treatment
category_summary <- dat %>%
  group_by(treatment, category) %>%  # Group by both treatment and category
  summarise(total_x = sum(PL_HH, na.rm = TRUE), .groups = "drop") %>%
  group_by(treatment) %>%  # Group again by treatment to calculate proportions correctly
  mutate(percentage = (total_x / sum(total_x)) * 100) %>%
  ungroup()



e <-
ggplot(category_summary, 
       aes(x = treatment, 
           y = percentage, 
           fill = category)) +
  geom_col(position = "stack") +  # Stacked bars
  scale_fill_brewer(palette = "Set1") +  # Change to any Brewer palette
  labs(subtitle = "Human Health",
       x = "Treatment",
       y = "Proportion (%)",
       fill = "Pesticide Category") +
  theme_minimal()


e

```



# joint plot 


```{r joint plot}

ggarrange(c,d,e,a,b, 
          ncol = 5, 
          nrow = 1, 
          labels = c("A","B","C","D","E"), 
          common.legend = TRUE, legend = "bottom")

```


```{r}

ggsave(filename = "sym_link_pesticide_data/plots/pesticide_risk_plots/danish_pli_proportion_joint_plot.png",
       width = 11.5, height = 3.5)

```






#__________________________________
# General value plots 


# ~ DT50 & GUS plots 


```{r GUS & soil DT50 plots}

### ~~ general soil half life plot ####

# Assuming 'combined_dat' has a column for 'Pesticide' and 'Soil degradation'
gus_plot <- ggplot(combined_dat, 
            aes(x = ai_name, 
                y = GUS.leaching.potential.index.GUS.leaching.potential.index.GUS.leaching.potential.index, 
                fill = ai_name)) +
  geom_col() +  # Use geom_col() when you already have the values
  theme_minimal() +
  ylim(0,10) +
  labs(
    title = "Groundwater Ubiquity Score (GUS)",
    x = "Pesticide Active Ingrdient",
    y = "GUS",
    fill = "Active Ingrdient"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_blank(),  # Remove x-axis labels
    axis.ticks.x = element_blank()  # Optionally remove x-axis ticks
  )



# Assuming 'combined_dat' has a column for 'Pesticide' and 'Soil degradation'
soil_dt50 <- ggplot(combined_dat, 
            aes(x = ai_name, 
                y = Soil.degradation..days...aerobic..DT....field..DT....field., 
                fill = ai_name)) +
  geom_col() +  # Use geom_col() when you already have the values
  theme_minimal() + 
  ylim(0,800) +
  labs(
    y = expression("Field" ~ DT[50] ~ "(days)"),
    x = "Pesticide Active Ingrdient",
    title = expression("Soil Degradation Time " ~ DT[50] ~ "(days)"),
    fill = "Active Ingrdient"
  ) +
  theme_classic() +
  theme(
    axis.text.x = element_blank(),  # Remove x-axis labels
    axis.ticks.x = element_blank()  # Optionally remove x-axis ticks
  )



```



Create the joint plot of Soil degradation half life

```{r soil dt50 combination plot}

ggarrange(soil_dt50, gus_plot, 
          ncol = 2, 
          nrow = 1, 
          labels = c("A","B"), 
          common.legend = TRUE, 
          legend = "bottom", align = "h")
```

```{r save dt50 combo plot}
ggsave(filename = "~/OneDrive - Harper Adams University/Data/agronomy/plots/pesticide_risk_plots/fig_field_dt50_gus_plot.png", 
       width = 10, height = 5.5)

```








#____________________________________________________________####
# TOXICITY by AI



```{r ecotoxicity by AI}

### ~~ mammals ####

# Assuming 'combined_dat' has a column for 'Pesticide' and 'Soil degradation'
a <- ggplot(combined_dat, 
            aes(x = ai_name, 
                y = Mammals...Acute.oral.LD....mg.kg....Mammals...Acute.oral.LD....mg.kg....Mammals...Acute.oral.LD....mg.kg..., 
                fill = ai_name)) +
  geom_col() +  # Use geom_col() when you already have the values
  theme_minimal() +
  # ylim(0,800) +
  labs(
    title = expression("Mammals - Acute oral" ~ LD[50] ~ (mg ~ kg^{-1})),
    x = "Pesticide Active Ingrdient",
    y = expression(LD[50] ~ (mg ~ kg^{-1})),
    fill = "Active Ingrdient"
  ) +
  theme_bw() +
  theme(
    axis.text.x = element_blank(),  # Remove x-axis labels
    axis.ticks.x = element_blank()  # Optionally remove x-axis ticks
  )
# theme(axis.text.x = element_text(angle = -45, hjust = 0))  # Rotate x-axis labels if necessary

a




### ~~ worms ####

# Assuming 'combined_dat' has a column for 'Pesticide' and 'Soil degradation'
b <- ggplot(combined_dat, 
            aes(x = ai_name, 
                y = Earthworms...Acute.14.day.LC....mg.kg....Earthworms...Acute.14.day.LC....mg.kg....Earthworms...Acute.14.day.LC....mg.kg..., 
                fill = ai_name)) +
  geom_col() +  # Use geom_col() when you already have the values
  theme_minimal() +
  # ylim(0,800) +
  labs(
    title = expression("Earthworms - Acute oral" ~ LD[50] ~ (mg ~ kg^{-1})),
    x = "Pesticide Active Ingrdient",
    y = expression(LD[50] ~ (mg ~ kg^{-1})),
    fill = "Active Ingrdient"
  ) +
  theme_bw() +
  theme(
    axis.text.x = element_blank(),  # Remove x-axis labels
    axis.ticks.x = element_blank()  # Optionally remove x-axis ticks
  )
# theme(axis.text.x = element_text(angle = -45, hjust = 0))  # Rotate x-axis labels if necessary

b



### ~~ birds ####

# Assuming 'combined_dat' has a column for 'Pesticide' and 'Soil degradation'
c <- ggplot(combined_dat, 
            aes(x = ai_name, 
                y = Birds...Acute.LD....mg.kg....Birds...Acute.LD....mg.kg....Birds...Acute.LD....mg.kg..., 
                fill = ai_name)) +
  geom_col() +  # Use geom_col() when you already have the values
  theme_minimal() +
  # ylim(0,800) +
  labs(
    title = expression("Birds - Acute" ~ LD[50] ~ (mg ~ kg^{-1})),
    x = "Pesticide Active Ingrdient",
    y = expression(LD[50] ~ (mg ~ kg^{-1})),
    fill = "Active Ingrdient"
  ) +
  theme_bw() +
  theme(
    axis.text.x = element_blank(),  # Remove x-axis labels
    axis.ticks.x = element_blank()  # Optionally remove x-axis ticks
  )
# theme(axis.text.x = element_text(angle = -45, hjust = 0))  # Rotate x-axis labels if necessary

c

### ~~ fish ####

# Assuming 'combined_dat' has a column for 'Pesticide' and 'Soil degradation'
d <- ggplot(combined_dat, 
            aes(x = ai_name, 
                y = Temperate.Freshwater.Fish...Acute.96.hour.LC....mg.l....Temperate.Freshwater.Fish...Acute.96.hour.LC....mg.l....Temperate.Freshwater.Fish...Acute.96.hour.LC....mg.l..., 
                fill = ai_name)) +
  geom_col() +  # Use geom_col() when you already have the values
  theme_minimal() +
  # ylim(0,800) +
  labs(
    title = expression("Freshwater Fish - Acute 96 hr" ~ LC[50] ~ (mg ~ l^{-1})),
    x = "Pesticide Active Ingrdient",
    y = expression(LC[50] ~ (mg ~ l^{-1})),
    fill = "Active Ingrdient"
  ) +
  theme_bw() +
  theme(
    axis.text.x = element_blank(),  # Remove x-axis labels
    axis.ticks.x = element_blank()  # Optionally remove x-axis ticks
  )
# theme(axis.text.x = element_text(angle = -45, hjust = 0))  # Rotate x-axis labels if necessary

d


### ~~ Bees ####

# Plot title using expression
plot_title <- expression(
  "Honeybees (" * italic("Apis spp.") * ") Contact acute LD" [50] *
    " (" * mu * "g bee" ^ -1 * ")"
)

# Assuming 'combined_dat' has a column for 'Pesticide' and 'Soil degradation'
e <- ggplot(combined_dat, 
            aes(x = ai_name, 
                y = Honeybees..Apis.spp...Honeybees..Apis.spp...Contact.acute.LD....worst.case.from.24..48.and.72.hour.values...Î¼g.bee..., 
                fill = ai_name)) +
  geom_col() +  # Use geom_col() when you already have the values
  theme_minimal() +
  # ylim(0,800) +
  labs(
    title = plot_title,
    x = "Pesticide Active Ingrdient",
    y = expression(
      "LD" [50] *
        " (" * mu * "g bee" ^ -1 * ")"
    ),
    fill = "Active Ingrdient"
  ) +
  theme_bw() +
  theme(
    axis.text.x = element_blank(),  # Remove x-axis labels
    axis.ticks.x = element_blank()  # Optionally remove x-axis ticks
  )
# theme(axis.text.x = element_text(angle = -45, hjust = 0))  # Rotate x-axis labels if necessary

e




```

## ~ Combined Toxicity plot 

```{r combo ecotox plot}
ggarrange(a,b,c,d,e, 
          ncol = 3, 
          nrow = 2, 
          common.legend = TRUE, 
          legend = "bottom", 
          labels = c("A","B","C","D","E"))

```

```{r save combo ecotox plot}
ggsave(filename = "~/OneDrive - Harper Adams University/Data/agronomy/plots/pesticide_risk_plots/fig_ecotox_pesticide_values.png", 
       width = 13, height = 8)

```


```{r combo larger plot}

ggarrange(soil_a, soil_b, soil_c, gus,
  a,b,c,d,e, 
          ncol = 3, 
          nrow = 3, 
          common.legend = TRUE, 
          legend = "bottom", 
          labels = c("A","B","C","D","E"))

```
```{r}
ggsave(filename = "plots/pesticide_risk_plots/fig_all_ecotox_pesticide_values.png", width = 13, height = 13)

```





#________________________________####
# BARPLOTS





## ~ general indexes by treatment year


```{r}

### ~~ TLI barplots ####

# plot TLI by treatment and year
tli_plot <-
  ggplot(data = tli_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Toxic Load Index (TLI)", 
    x = "Treatment",
    y = "TLI",
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

tli_plot


### ~~ PLI barplots ####

# plot PLI by treatment and year
pli_plot <-
  ggplot(data = pli_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Pesticide Load Index (PLI)", 
    x = "Treatment",
    y = "PLI",
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

pli_plot



### ~~ GUS index ####

# plot worm index by treatment and year
gus_plot <-
  ggplot(data = GUS_index_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Groundwater Ubiquity Score (GUS) Index", 
    x = "Treatment",
    y = "GUS Index",
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

gus_plot



```


```{r}

ggarrange(pli_plot, tli_plot, gus_plot, 
          ncol = 3, 
          nrow = 1, 
          common.legend = TRUE, 
          legend = "bottom", labels = c("A","B","C"))

```


save PLI, TLI, AND GUS PLOT

```{r}
ggsave(filename = "plots/pesticide_risk_plots/pli_tli_gus.png", width = 10, height = 4)

```



## ~ eco risk plot by treatment x year ####


```{r}

### ~~ worm risk index ####

# plot worm index by treatment and year
worm_plot <-
  ggplot(data = pli_worms_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    x = "Treatment",
    y = "PLI",
    subtitle = "Earthworm PLI", 
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

worm_plot


### ~~ mammal risk index ####

# plot worm index by treatment and year
mammal_plot <-
  ggplot(data = pli_mammal_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    x = "Treatment",
    y = "PLI",
    subtitle = "Mammal PLI", 
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

mammal_plot



### ~~ birds risk index ####

# plot worm index by treatment and year
birds_plot <-
  ggplot(data = pli_birds_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Birds PLI",
    x = "Treatment",
    y = "PLI",
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 
birds_plot



### ~~ bee risk index ####


# Plot title using expression
plot_title <- expression("Honey Bee (" * italic("Apis spp.") * ") PLI")

# plot worm index by treatment and year
bee_plot <-
  ggplot(data = pli_bees_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = plot_title,
    x = "Treatment",
    y = "PLI",
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 
bee_plot


### ~~ fish risk index ####

# plot worm index by treatment and year
fish_plot <-
  ggplot(data = pli_fish_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "Freshwater Fish PLI",
    x = "Treatment",
    y = "PLI",
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 
fish_plot



### ~~ gus risk index ####

# plot worm index by treatment and year
gus_plot <-
  ggplot(data = GUS_index_sum, 
         aes(x = treatment, 
             y = sum, 
             fill = treatment)) + 
  geom_bar(stat = "identity", 
           color = "black", 
           position = "dodge") + 
  labs(
    subtitle = "GUS Index", 
    x = "Treatment",
    y = "GUS Index",
    caption = "") +
  theme_bw() +
  scale_fill_manual(values=c("turquoise3","tomato2"), 
                    name = "Treatment") +
  theme(strip.text.x = element_text(size = 12, 
                                    color = "black", 
                                    face = "bold.italic"), 
        legend.position = "bottom", 
        axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  facet_wrap(~ year, 
             ncol = 4, 
             scales = 'free_x') 

gus_plot


```




```{r}

ggarrange(worm_plot, bee_plot, mammal_plot, birds_plot, fish_plot, gus_plot, 
          ncol = 3, 
          nrow = 2, 
          common.legend = TRUE, 
          legend = "bottom", 
          labels = c("A","B","C","D", "E","F","G"))

```


```{r}

ggsave(filename = "~/OneDrive - Harper Adams University/Data/agronomy/plots/pesticide_risk_plots/ecotox_risk_indexes.png",
       width = 10, height = 6)

```

